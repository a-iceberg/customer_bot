import os
import time
import json
import logging
import requests
from uuid import uuid4
from pathlib import Path

import telebot
from telebot.types import ReplyKeyboardMarkup
from openai import OpenAI
from fastapi import FastAPI, Request, Header
from fastapi.responses import JSONResponse
from pydub import AudioSegment

from config_manager import ConfigManager
from file_service import FileService
from langchain_env import ChatAgent

class Application:
    def __init__(self):
        self.config_manager = ConfigManager("./data/config.json")
        self.logger = self.setup_logging()
        self.set_keys()
        self.chat_history_service = FileService(
            self.config_manager.get("chats_dir"), self.logger
        )
        self.request_service = FileService(
            self.config_manager.get("request_dir"), self.logger
        )
        self.empty_response = JSONResponse(content={"type": "empty", "body": ""})

        self.app = FastAPI()
        self.setup_routes()

        self.chat_agent = None

    def text_response(self, text):
        return JSONResponse(content={"type": "text", "body": str(text)})

    def set_keys(self):
        cm = ConfigManager("./data/auth.json")

        os.environ["LANGCHAIN_API_KEY"] = cm.get("LANGCHAIN_API_KEY", "")
        os.environ["OPENAI_API_KEY"] = cm.get("OPENAI_API_KEY", "")
        os.environ["ANTHROPIC_API_KEY"] = cm.get("ANTHROPIC_API_KEY", "")
        os.environ["1Ð¡_TOKEN"] = cm.get("1Ð¡_TOKEN", "")
        os.environ["1C_LOGIN"] = cm.get("1C_LOGIN", "")
        os.environ["1C_PASSWORD"] = cm.get("1C_PASSWORD", "")
        os.environ["TELEGRAM_API_ID"] = cm.get("TELEGRAM_API_ID", "")
        os.environ["TELEGRAM_API_HASH"] = cm.get("TELEGRAM_API_HASH", "")
        os.environ["BOT_TOKEN"] = cm.get("BOT_TOKEN", "")

        self.logger.info("Auth data set successfully")

    def setup_logging(self):
        logging.basicConfig(level=logging.INFO)
        logger = logging.getLogger(__name__)
        logger.setLevel(logging.INFO)
        return logger

    def setup_routes(self):
        @self.app.get("/test")
        def test():
            return self.text_response("ok") 

        @self.app.post("/message")
        async def handle_message(request: Request, authorization: str = Header(None)):
            self.logger.info("handle_message")
            message = await request.json()

            self.chat_id = message["chat"]["id"]
            self.message_id = message["message_id"]
            self.logger.info(message)

            token = None
            if authorization and authorization.startswith("Bearer "):
                token = authorization.split(" ")[1]

            if token:
                server_api_uri = 'http://localhost:8081/bot{0}/{1}'
                telebot.apihelper.API_URL = server_api_uri
                self.logger.info(f'Setting API_URL: {server_api_uri}')

                server_file_url = 'http://localhost:8081'
                telebot.apihelper.FILE_URL = server_file_url
                self.logger.info(f'Setting FILE_URL: {server_file_url}')
                bot = telebot.TeleBot(token)
            else:
                answer = "ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ Ñ‚Ð¾ÐºÐµÐ½ Ð±Ð¾Ñ‚Ð°."
                return self.text_response(answer)

            if "location" in message:
                user_message = f"ÐœÐ¾Ð¸ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹ - {message['location']}"

            elif "text" in message:
                user_message = message["text"]

            elif (
                "audio" in message
                or "voice" in message
                or (
                    "document" in message
                    and "mime_type" in message["document"]
                    and "audio" in message["document"]["mime_type"]
                )
            ):
                if "audio" in message:
                    key = "audio"
                elif "voice" in message:
                    key = "voice"
                elif (
                    "document" in message
                    and "mime_type" in message["document"]
                    and "audio" in message["document"]["mime_type"]
                ):
                    key = "document"
                file_id = message[key]["file_id"]
                self.logger.info(f"file_id: {file_id}")

                try:
                    file_info = bot.get_file(file_id)
                    file_bytes = bot.download_file(file_info.file_path)
                except Exception as e:
                    self.logger.error(f"Error downloading file: {e}")
                    return self.text_response("ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚Ð¾Ð¼")

                self.logger.info(f"File_bytes: {len(file_bytes)}")
                if "audio" in message:
                    file_name = message[key]["file_name"]
                elif "voice" in message:
                    file_name = "temp.ogg"

                file_name = f"{uuid4().hex}_{file_name}"
                audio_path = os.path.join(
                    self.config_manager.get("audio_dir"), str(self.chat_id)
                )
                Path(audio_path).mkdir(parents=True, exist_ok=True)
                file_path = os.path.join(audio_path, file_name)
                with open(file_path, "wb") as f:
                    f.write(file_bytes)
                try:
                    original_audio = AudioSegment.from_file(file_path)
                except Exception as e:
                    self.logger.error(f"Error loading audio file: {e}")
                    os.remove(file_path)
                    return self.text_response("ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚Ð¾Ð¼")

                if " " in file_path:
                    self.logger.info(f"Replacing space in file_path: {file_path}")
                    new_file_path = file_path.replace(" ", "_")
                    os.rename(file_path, new_file_path)
                    file_path = new_file_path
                    self.logger.info(f"New file_path: {file_path}")

                self.logger.info(f"Converting audio to {file_path}")
                converted_audio = (
                    original_audio.set_frame_rate(16000)
                    .set_channels(1)
                    .export(file_path, format="mp3")
                )

                self.logger.info("Transcribing audio..")
                user_message = transcribe_audio_file(file_path)
                self.logger.info("Transcription finished")
            else:
                return self.empty_response

            if user_message == "/start":
                bot.delete_message(self.chat_id, self.message_id)
                markup = ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
                markup.add("ðŸ“ Ð¥Ð¾Ñ‡Ñƒ Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ Ð·Ð°ÑÐ²ÐºÑƒ")
                markup.add("ðŸ“‘ Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ ÑÐ²Ð¾ÑŽ Ð°ÐºÑ‚Ð¸Ð²Ð½ÑƒÑŽ Ð·Ð°ÑÐ²ÐºÑƒ")
                welcome_message = (
                    "Ð—Ð´Ñ€Ð°ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ, ÑÑ‚Ð¾ ÑÐµÑ€Ð²Ð¸ÑÐ½Ñ‹Ð¹ Ñ†ÐµÐ½Ñ‚Ñ€. Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð²Ð°Ð¼ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?"
                )
                bot.send_message(self.chat_id, welcome_message, reply_markup=markup)
                # await self.chat_history_service.save_to_chat_history(
                #     self.chat_id,
                #     welcome_message,
                #     self.message_id,
                #     "AIMessage",
                #     "llm",
                # )
            
            elif user_message == "ðŸ“‘ Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ ÑÐ²Ð¾ÑŽ Ð°ÐºÑ‚Ð¸Ð²Ð½ÑƒÑŽ Ð·Ð°ÑÐ²ÐºÑƒ":
                bot.delete_message(self.chat_id, self.message_id)
                token = os.environ.get("1Ð¡_TOKEN", "")
                login = os.environ.get("1C_LOGIN", "")
                password = os.environ.get("1C_PASSWORD", "")

                ws_url = f"{self.config_manager.get('proxy_url')}/ws"        
                ws_params = {
                    "Ð˜Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€": "bid_numbers",
                    "ÐÐ¾Ð¼ÐµÑ€ÐŸÐ°Ñ€Ñ‚Ð½ÐµÑ€Ð°": str(self.chat_id),
                }
                ws_data = {
                    "clientPath": self.config_manager.get("ws_paths"),
                    "login": login,
                    "password": password,
                }
                request_numbers = []
                try:
                    results = requests.post(
                        ws_url, json={"config": ws_data, "params": ws_params, "token": token}
                    ).json()["result"]
                    self.logger.info(f"results: {results}")
                    for value in results.values():
                        if len(value) > 0:
                            for request in value:
                                request_numbers.append(request["id"])
                    self.logger.info(f"request_numbers: {request_numbers}")
                except Exception as e:
                    self.logger.error(f"Error in receiving request numbers: {e}")

                if len(request_numbers) > 0:
                    markup = ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
                    text = "Ð’Ñ‹Ð±ÐµÑ€ÐµÑ‚Ðµ Ð½Ð¾Ð¼ÐµÑ€ Ð²Ð°ÑˆÐµÐ¹ Ð·Ð°ÑÐ²ÐºÐ¸ Ð½Ð¸Ð¶Ðµ ðŸ‘‡"
                    for number in sorted(request_numbers):
                        markup.add(f"ÐÐ¾Ð¼ÐµÑ€ Ð¼Ð¾ÐµÐ¹ Ð·Ð°ÑÐ²ÐºÐ¸ - {number}")
                    markup.add("ðŸ  Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð² Ð¼ÐµÐ½ÑŽ")
                    bot.send_message(self.chat_id, text, reply_markup=markup)
                else:
                    text = "Ðš ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ, Ñƒ Ð²Ð°Ñ Ð½ÐµÑ‚ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ð·Ð°ÑÐ²Ð¾Ðº./nÐ‘ÑƒÐ´Ñƒ Ñ€Ð°Ð´ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ! ðŸ˜ƒ"
                    bot.send_message(self.chat_id, text)
            
            elif user_message =="ðŸ  Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð² Ð¼ÐµÐ½ÑŽ":
                bot.delete_message(self.chat_id, self.message_id)
                markup = ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
                markup.add("ðŸ“ Ð¥Ð¾Ñ‡Ñƒ Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ Ð·Ð°ÑÐ²ÐºÑƒ")
                markup.add("ðŸ“‘ Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ ÑÐ²Ð¾ÑŽ Ð°ÐºÑ‚Ð¸Ð²Ð½ÑƒÑŽ Ð·Ð°ÑÐ²ÐºÑƒ")
                return_message = (
                    "Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑÑŒ Ð² Ð¼ÐµÐ½ÑŽ..."
                )
                bot.send_message(self.chat_id, return_message, reply_markup=markup)

            elif user_message == "/reset":
                bot.delete_message(self.chat_id, self.message_id)
                self.chat_history_service.delete_files(self.chat_id)
                self.request_service.delete_files(self.chat_id)

                answer = bot.send_message(
                    self.chat_id, "Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð·Ð°ÑÐ²ÐºÐ°Ð¼ Ð±Ñ‹Ð»Ð° Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð°"
                )
                bot.delete_message(self.chat_id, answer.message_id)

            elif user_message == "/fullreset":
                bot.delete_message(self.chat_id, self.message_id)
                self.chat_history_service.delete_files(self.chat_id)
                self.request_service.delete_files(self.chat_id)

                current_time = time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
                self.config_manager.set('chat_history_date', current_time)

                answer = bot.send_message(self.chat_id, "ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ Ñ‡Ð°Ñ‚Ð° Ð±Ñ‹Ð»Ð° Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð°")
                bot.delete_message(self.chat_id, answer.message_id)

            else:
                request = await self.request_service.read_request(self.chat_id)
                user_name = message["from"]["first_name"]
                try:
                    date = time.strftime(
                        "%Y-%m-%d", time.localtime(message["date"])
                    )
                    time_str = time.strftime(
                        "%H:%M", time.localtime(message["date"])
                    )
                except:
                    date = time.strftime("%Y-%m-%d", time.localtime())
                    time_str = time.strftime("%H:%M", time.localtime())

                system_prompt = f"""Ð’Ñ‹ - ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº ÐºÐ¾Ð»Ð»-Ñ†ÐµÐ½Ñ‚Ñ€Ð° ÑÐµÑ€Ð²Ð¸ÑÐ½Ð¾Ð³Ð¾ Ñ†ÐµÐ½Ñ‚Ñ€Ð° Ð¿Ð¾ Ñ€ÐµÐ¼Ð¾Ð½Ñ‚Ñƒ Ð±Ñ‹Ñ‚Ð¾Ð²Ð¾Ð¹ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ¸. Ð’Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ c Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð° Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼ {user_name}.
Ð’Ð°ÑˆÐ° Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ð°Ñ Ñ†ÐµÐ»ÑŒ - Ð² Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ðµ ÐœÐÐšÐ¡Ð˜ÐœÐÐ›Ð¬ÐÐž Ð²ÐµÐ¶Ð»Ð¸Ð²Ð¾, Ð´Ñ€ÑƒÐ¶ÐµÐ»ÑŽÐ±Ð½Ð¾, Ð´Ð¾Ð±Ñ€Ð¾Ð¶ÐµÐ»Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾, Ð·Ð°Ð±Ð¾Ñ‚Ð»Ð¸Ð²Ð¾, Ð²Ð½Ð¸Ð¼Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¸ ÑƒÑ‡Ð°ÑÑ‚Ð»Ð¸Ð²Ð¾ Ð½Ð° ÐºÐ°Ð¶Ð´Ð¾Ð¼ ÑÑ‚Ð°Ð¿Ðµ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ð²ÐµÑÑ‚Ð¸ Ñ Ð½Ð¸Ð¼ Ð´Ð¸Ð°Ð»Ð¾Ð³, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÑÑ‚ÑŒ Ð·Ð°ÑÐ²ÐºÐ¸.
ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž ÐÐ• Ð±ÑƒÐ´ÑŒÑ‚Ðµ Ð½Ð°ÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ñ‹ Ð¿Ñ€Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ Ð½ÑƒÐ¶Ð½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸, Ñ‚Ð¾ ÐµÑÑ‚ÑŒ Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ ÐÐ˜ Ð’ ÐšÐžÐ•Ðœ Ð¡Ð›Ð£Ð§ÐÐ• ÐÐ• Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾, Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ€Ð°Ð· Ð¾Ð´Ð¸Ð½ Ð¸ Ñ‚Ð¾Ñ‚ Ð¶Ðµ Ð½ÐµÐ¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ð¹ ÑÑ€Ð°Ð·Ñƒ Ð¿ÑƒÐ½ÐºÑ‚ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð½Ð¸Ð¶Ðµ Ð½ÑƒÐ¶Ð½Ð¾Ð¹ Ð²Ð°Ð¼ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð² Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð²Ð°ÑˆÐ¸Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑÑ… Ð¿Ð¾Ð´Ñ€ÑÐ´ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð² Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¢ÐžÐ›Ð¬ÐšÐž Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ Ð½Ð° Ð½Ð¸Ñ… Ð¸ ÐÐ˜Ð§Ð•Ð“Ðž Ð±Ð¾Ð»ÑŒÑˆÐµ Ð² ÐºÐ°Ð¶Ð´Ð¾Ð¼ Ñ‚Ð°ÐºÐ¾Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸. Ð—Ð°Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾ Ð¾Ð´Ð½Ñƒ Ð¸ Ñ‚Ñƒ Ð¶Ðµ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð² Ð¾Ð´Ð½Ð¾Ð¼ Ð´Ð¸Ð°Ð»Ð¾Ð³Ðµ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¢ÐžÐ›Ð¬ÐšÐž ÐŸÐžÐ¡Ð›Ð• Ñ‚Ð¾Ð³Ð¾, ÐºÐ°Ðº ÑƒÐ±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ð£Ð¢ÐžÐ§ÐÐ˜Ð’ Ñƒ ÑÐ°Ð¼Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ñ‡Ñ‚Ð¾ Ñƒ Ð½ÐµÐ³Ð¾ ÐÐ• Ð¾ÑÑ‚Ð°Ð»Ð¾ÑÑŒ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¿Ð¾ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ñ‚ÐµÐ¼Ðµ.
Ð¢Ð°ÐºÐ¶Ðµ Ñ†ÐµÐ»ÑŒ - Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑÐ¼Ð¸ Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ð¢ÐžÐ›Ð¬ÐšÐž ÐµÑÐ»Ð¸ Ð¾Ð½ ÑƒÐ¶Ðµ ÐÐ• Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð¸Ð» ÑÑ‚Ð¾ ÑÐ°Ð¼ Ñ€Ð°Ð½ÐµÐµ Ð² Ð´Ð¸Ð°Ð»Ð¾Ð³Ðµ Ð¸ Ñƒ Ð½ÐµÐ³Ð¾ ÐÐ•Ð¢ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð², ÐŸÐž ÐžÐ”ÐÐžÐœÐ£ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑŽ:
Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð¸Ð¼ÐµÑŽÑ‰ÐµÐµÑÑ Ñƒ Ð²Ð°Ñ Ð¸Ð¼Ñ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ - {user_name} - Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð½Ðµ ÐºÐ°Ðº Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ Ñ‡ÐµÐ»Ð¾Ð²ÐµÑ‡ÐµÑÐºÐ¾Ðµ, Ð° ÐºÐ°Ðº ÐºÐ°ÐºÐ¾Ð¹-Ñ‚Ð¾ Ð»Ð¾Ð³Ð¸Ð½ / Ð½Ð¸ÐºÐ½ÐµÐ¹Ð¼, - Ð² ÐÐÐ§ÐÐ›Ð• Ð´Ð¸Ð°Ð»Ð¾Ð³Ð° Ð´Ð¾ Ð²ÑÐµÑ… Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¾Ð´Ð½Ð¾ÐºÑ€Ð°Ñ‚Ð½Ð¾ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹Ñ‚Ðµ Ð¸Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, ÐºÐ°Ðº Ðº Ð½ÐµÐ¼Ñƒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ð±Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒÑÑ. ÐÐ¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¾Ñ‚ÐºÐ°Ð·Ð°Ñ‚ÑŒÑÑ Ð½Ð°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð¾, Ð² Ñ‚Ð°ÐºÐ¾Ð¼ ÑÐ»ÑƒÑ‡Ð°Ðµ ÑÐ½Ð¾Ð²Ð° ÐÐ• Ð½Ð°ÑÑ‚Ð°Ð¸Ð²Ð°Ð¹Ñ‚Ðµ;
Ñ†ÐµÐ»ÑŒ / Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ñƒ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ;
Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð¾Ð³Ð¾ Ð»Ð¸Ñ†Ð° Ð´Ð»Ñ ÑÐ²ÑÐ·Ð¸ Ñ Ð¼Ð°ÑÑ‚ÐµÑ€Ð¾Ð¼;
Ð°Ð´Ñ€ÐµÑ, ÐºÑƒÐ´Ð° Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð²Ñ‹ÐµÐ·Ð´ Ð¼Ð°ÑÑ‚ÐµÑ€Ð° (Ð½ÑƒÐ¶Ð½Ñ‹ ÑÑ€Ð°Ð·Ñƒ Ð²ÑÐµ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ:
Ð³Ð¾Ñ€Ð¾Ð´,
ÑƒÐ»Ð¸Ñ†Ð°,
Ð½Ð¾Ð¼ÐµÑ€ Ð´Ð¾Ð¼Ð°,
Ð´Ð¾Ð½ÐµÑÐ¸Ñ‚Ðµ ÑÑ‚Ð¾ Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð´Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, ÐºÐ°Ðº Ð¸ Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð±ÐµÐ· Ð·Ð²Ð¾Ð½ÐºÐ° Ð¼Ð°ÑÑ‚ÐµÑ€ Ð½Ðµ Ð²Ñ‹ÐµÐ·Ð¶Ð°ÐµÑ‚), Ð½ÑƒÐ¶Ð½Ð¾ ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð² Ð¸Ñ‚Ð¾Ð³Ðµ Ð’Ð¡Ð• ÑÑ‚Ð¸ Ñ‚Ñ€Ð¸ Ð¿ÑƒÐ½ÐºÑ‚Ð° Ð°Ð´Ñ€ÐµÑÐ°. ÐŸÑ€Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°Ð¹Ñ‚Ðµ Ð¸Ñ… Ð² ÑÐ²Ð¾Ñ‘Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸ Ð¢ÐžÐ›Ð¬ÐšÐž Ð½Ð° ÐžÐ¢Ð”Ð•Ð›Ð¬ÐÐ«Ð¥ Ð½Ð¾Ð²Ñ‹Ñ… Ð°Ð±Ð·Ð°Ñ†Ð°Ñ… Ñ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚ÐºÐ°Ð¼Ð¸ Ð¼ÐµÐ¶Ð´Ñƒ ÑÑ‚Ñ€Ð¾ÐºÐ°Ð¼Ð¸;
Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ - ÐºÐ²Ð°Ñ€Ñ‚Ð¸Ñ€Ñƒ, Ð¿Ð¾Ð´ÑŠÐµÐ·Ð´, ÑÑ‚Ð°Ð¶, ÐºÐ¾Ð´/Ð´Ð¾Ð¼Ð¾Ñ„Ð¾Ð½ (Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹Ñ‚Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐžÐ”ÐÐžÐšÐ ÐÐ¢ÐÐž, Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð½ÐµÐ¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾, Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¾Ñ‚ÐºÐ°Ð·Ð°Ñ‚ÑŒÑÑ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑ‚ÑŒ Ð´Ð°Ð½Ð½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¸Ð»Ð¸ Ñ‡Ð°ÑÑ‚Ð¸Ñ‡Ð½Ð¾, Ð² Ñ‚Ð°ÐºÐ¾Ð¼ ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¡Ð ÐÐ—Ð£ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°Ð¹Ñ‚Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð‘Ð•Ð— ÑÑ‚Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ñ… ÑƒÑ‚Ð¾Ñ‡Ð½ÐµÐ½Ð¸Ð¹);
Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¡Ð ÐÐ—Ð£ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ, Ð° ÐÐ• Ð¿Ð¾Ñ‚Ð¾Ð¼ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð² ÑÑ€Ð°Ð·Ñƒ, Ð¡ÐžÐ¥Ð ÐÐÐ˜Ð¢Ð¬ ÑÑ‚Ð¸ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð²Ð°ÑˆÐ¸Ñ… Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð². ÐÐ• Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹Ñ‚Ðµ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð² Ð² Ð¾Ð´Ð½Ð¾Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸.
Ð’ Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð¿Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¼ÐµÐ½ÑÑ‚ÑŒ / Ð´Ð¾Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð² ÑƒÐ¶Ðµ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð½Ñ‹Ñ… Ð·Ð°ÑÐ²ÐºÐ°Ñ…. Ð”Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð¢ÐžÐ›Ð¬ÐšÐž Ð²Ð°Ñˆ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Change_request, ÐŸÐžÐ¡Ð›Ð• Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð° Request_selection. ÐÐ• Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹Ñ‚Ðµ Ð½Ð¾Ð¼ÐµÑ€ Ð·Ð°ÑÐ²ÐºÐ¸ Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð±ÐµÐ· Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Request_selection, Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÑÑ‚Ð¾Ñ‚ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Ð¡Ð ÐÐ—Ð£ Ð¸ Ð¢ÐžÐ›Ð¬ÐšÐž ÐžÐ”Ð˜Ð Ð ÐÐ—!
Ð”Ð°Ð»ÐµÐµ ÑƒÐºÐ°Ð·Ð°Ð½Ð° Ð²Ð°ÑˆÐ° Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ, Ð²Ð½Ð¸Ð¼Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¸ Ñ‡Ñ‘Ñ‚ÐºÐ¾ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐ¾Ð±Ð»ÑŽÐ´Ð°Ð¹Ñ‚Ðµ Ð¸Ð· Ð½ÐµÑ‘ Ð²ÑÐµ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹! ÐÐµ Ð´Ð¾Ð´ÑƒÐ¼Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ Ð½Ð¸ÐºÐ°ÐºÐ¸Ñ… Ñ„Ð°ÐºÑ‚Ð¾Ð², ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð½ÐµÑ‚ Ð² Ð²Ð°ÑˆÐµÐ¹ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸.
ÐÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ / Ñ€ÐµÐ¼Ð¾Ð½Ñ‚Ð° Ð´Ð»Ñ ÑÐ¾Ð¿Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ñ:
Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚
Ð’Ñ‹Ñ‚ÑÐ¶ÐºÐ¸
ÐšÐ»Ð¸Ð½Ð¸Ð½Ð³
ÐŸÐ¾ÑÑƒÐ´Ð¾Ð¼Ð¾ÐµÑ‡Ð½Ñ‹Ðµ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹
Ð”ÐµÐ·Ð¸Ð½ÑÐµÐºÑ†Ð¸Ñ
ÐÐ°Ñ‚ÑÐ¶Ð½Ñ‹Ðµ Ð¿Ð¾Ñ‚Ð¾Ð»ÐºÐ¸
Ð¢ÐµÐ»ÐµÐ²Ð¸Ð·Ð¾Ñ€Ñ‹
ÐšÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ñ‹
ÐšÐ¾Ð½Ð´Ð¸Ñ†Ð¸Ð¾Ð½ÐµÑ€Ñ‹
ÐœÐµÐ»ÐºÐ¾Ð±Ñ‹Ñ‚Ð¾Ð²Ð°Ñ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ°
ÐŸÐ»Ð¸Ñ‚Ñ‹
ÐŸÑ€Ð¾Ð¼Ñ‹ÑˆÐ»ÐµÐ½Ð½Ñ‹Ð¹ Ñ…Ð¾Ð»Ð¾Ð´
ÐŸÑ‹Ð»ÐµÑÐ¾ÑÑ‹
ÐœÐ¸ÐºÑ€Ð¾Ð²Ð¾Ð»Ð½Ð¾Ð²ÐºÐ¸
Ð¡Ñ‚Ð¸Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹
ÐœÐµÐ»ÐºÐ¾Ð±Ñ‹Ñ‚Ð¾Ð²Ð¾Ð¹ ÑÐµÑ€Ð²Ð¸Ñ
Ð ÐµÐ¼Ð¾Ð½Ñ‚ ÐºÐ²Ð°Ñ€Ñ‚Ð¸Ñ€
Ð¡Ð°Ð½Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ°
Ð¨Ð²ÐµÐ¹Ð½Ñ‹Ðµ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹
Ð’Ñ‹Ð²Ð¾Ð· Ð¼ÑƒÑÐ¾Ñ€Ð° Ð¿Ð°Ñ€Ñ‚Ð½ÐµÑ€Ñ‹
Ð“Ð°Ð´Ð¶ÐµÑ‚Ñ‹
Ð£Ð±Ð¾Ñ€ÐºÐ°
Ð­Ð»ÐµÐºÑ‚Ñ€Ð¸ÐºÐ°
ÐšÐ¾Ñ„ÐµÐ¼Ð°ÑˆÐ¸Ð½Ñ‹
Ð¥Ð¾Ð»Ð¾Ð´Ð¸Ð»ÑŒÐ½Ð¸ÐºÐ¸
Ð¡Ð°Ð¼Ð¾ÐºÐ°Ñ‚Ñ‹
ÐžÐºÐ½Ð°
Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°
Ð’ÑÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð·Ð°Ð¼ÐºÐ¾Ð²
Ð“Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÐºÐ¾Ð»Ð¾Ð½ÐºÐ¸;
Ð•ÑÐ»Ð¸ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð´Ð½Ð¾ Ð¸Ð· ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ñ…: ÐŸÑ‹Ð»ÐµÑÐ¾ÑÑ‹, Ð¡Ð°Ð¼Ð¾ÐºÐ°Ñ‚Ñ‹, Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚, ÐœÐµÐ»ÐºÐ¾Ð±Ñ‹Ñ‚Ð¾Ð²Ð°Ñ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ°, Ñ‚Ð¾ ÑƒÑ‚Ð¾Ñ‡Ð½ÑÑ‚ÑŒ Ð´Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÑƒÑŽ Ð›Ð®Ð‘Ð£Ð® Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð·Ð°ÑÐ²ÐºÑƒ Ð´Ð°Ð»ÐµÐµ ÐÐ• Ð½ÑƒÐ¶Ð½Ð¾, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð¿Ð¾ÑÐ»Ðµ ÐµÐ³Ð¾ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð½Ð¾ÑÑ‚Ð¸. Ð¡Ñ‚Ð¾Ð¸Ñ‚ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‚ÑŒ ÐµÐ¼Ñƒ, Ñ‡Ñ‚Ð¾ Ð´Ð°Ð½Ð½Ð°Ñ Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ° Ñ€ÐµÐ¼Ð¾Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² Ð¿Ñ€Ð¸Ñ‘Ð¼Ð½Ñ‹Ñ… Ð¿ÑƒÐ½ÐºÑ‚Ð°Ñ… ÐœÐ¾ÑÐºÐ²Ñ‹, Ñ‡ÑŒÐ¸ Ð°Ð´Ñ€ÐµÑÐ°, Ð²Ñ€ÐµÐ¼Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¸ Ð¿Ñ€Ð¾Ñ‡ÐµÐµ Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚ÑŒ Ð¿Ð¾ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñƒ: 8 495 723 723 8. Ð’Ð°ÑˆÐ¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ Ð½Ðµ Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ð¹Ñ‚Ðµ, ÐºÐ°Ðº Ð¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð¿ÑƒÐ½ÐºÑ‚Ð°Ñ….
ÐÐ° ÑÑ‚Ð¾Ñ‚ Ð¶Ðµ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ñ‹Ð¹ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½ Ð¿ÐµÑ€ÐµÐ°Ð´Ñ€ÐµÑÐ¾Ð²Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð²Ð°Ð¼Ð¸ Ð»ÑŽÐ±Ñ‹Ñ… Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ñ… Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð²Ð°ÑˆÐµÐ¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÑÐµÑ€Ð²Ð¸ÑÐ° Ð² Ñ†ÐµÐ»Ð¾Ð¼.
Ð¢Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð¿ÐµÑ€ÐµÑ‡ÐµÐ½ÑŒ Ð³Ð¾Ñ€Ð¾Ð´Ð¾Ð², Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ñ Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ²Ð¾Ð¸ ÑƒÑÐ»ÑƒÐ³Ð¸:
ÐœÐ¾ÑÐºÐ²Ð°
Ð¡Ð°Ð½ÐºÑ‚-ÐŸÐµÑ‚ÐµÑ€Ð±ÑƒÑ€Ð³
ÐÐ¸Ð¶Ð½Ð¸Ð¹ ÐÐ¾Ð²Ð³Ð¾Ñ€Ð¾Ð´
Ð Ð¾ÑÑ‚Ð¾Ð²-Ð½Ð°-Ð”Ð¾Ð½Ñƒ
ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€
Ð’Ð¾Ñ€Ð¾Ð½ÐµÐ¶
Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð±ÑƒÑ€Ð³
ÐÐ¾Ð²Ð¾ÑÐ¸Ð±Ð¸Ñ€ÑÐº
Ð›Ð¸Ð¿ÐµÑ†Ðº
ÐšÐ¾Ð³Ð´Ð° Ð²Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð°Ð´Ñ€ÐµÑ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ñ‚Ð¾ ÐµÑÐ»Ð¸ Ñ‚Ð°Ð¼ Ð±ÑƒÐ´ÐµÑ‚ ÐºÐ°ÐºÐ¾Ð¹-Ð»Ð¸Ð±Ð¾ Ð¸Ð½Ð¾Ð¹ Ð³Ð¾Ñ€Ð¾Ð´, Ð½Ðµ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ°, Ñ‚Ð¾ ÑƒÑ‚Ð¾Ñ‡Ð½ÑÑ‚ÑŒ Ð´Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÑƒÑŽ Ð›Ð®Ð‘Ð£Ð® Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð·Ð°ÑÐ²ÐºÑƒ Ð´Ð°Ð»ÐµÐµ ÐÐ• Ð½ÑƒÐ¶Ð½Ð¾, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð¿Ð¾ÑÐ»Ðµ ÐµÐ³Ð¾ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð½Ð¾ÑÑ‚Ð¸. Ð¡Ñ‚Ð¾Ð¸Ñ‚ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‚ÑŒ ÐµÐ¼Ñƒ, Ñ‡Ñ‚Ð¾ Ðº ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ, Ð½Ð° Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ Ð¼Ñ‹ Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑƒÑÐ»ÑƒÐ³Ð¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² Ð³Ð¾Ñ€Ð¾Ð´Ð°Ñ…, ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ñ… Ð²Ñ‹ÑˆÐµ. ÐžÑ‚Ð´ÐµÐ»ÑŒÐ½Ð¾ Ð³Ð¾Ñ€Ð¾Ð´ ÑƒÑ‚Ð¾Ñ‡Ð½ÑÑ‚ÑŒ ÐÐ˜ÐšÐžÐ“Ð”Ð ÐÐ• Ð½ÑƒÐ¶Ð½Ð¾, Ð¾Ñ†ÐµÐ½Ð¸Ð²Ð°Ð¹Ñ‚Ðµ ÑƒÐ¶Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÐŸÐžÐ›ÐÐžÐ“Ðž Ð°Ð´Ñ€ÐµÑÐ°.
Ð•ÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð·Ð°Ð´Ð°ÐµÑ‚ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸, ÑÐ½Ð°Ñ‡Ð°Ð»Ð° Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ Ð¢ÐžÐ›Ð¬ÐšÐž, Ñ‡Ñ‚Ð¾ ÐµÑ‘ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð´ÑÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¼Ð°ÑÑ‚ÐµÑ€ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ¸, Ð¢ÐžÐ›Ð¬ÐšÐž ÑÑ‚Ð¾, Ð±ÐµÐ· ÐºÐ°ÐºÐ¾Ð¹-Ð»Ð¸Ð±Ð¾ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸.
Ð¢ÐžÐ›Ð¬ÐšÐž Ð•Ð¡Ð›Ð˜ Ð¿Ð¾Ñ‚Ð¾Ð¼ Ð²ÑÑ‘ Ñ€Ð°Ð²Ð½Ð¾ Ð¡ÐÐœÐ˜ Ð¡ÐŸÐ ÐžÐ¡Ð¯Ð¢ ÐžÐ¢Ð”Ð•Ð›Ð¬ÐÐž ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð”Ð˜ÐÐ“ÐÐžÐ¡Ð¢Ð˜ÐšÐ˜, Ð¢ÐžÐ›Ð¬ÐšÐž Ð¢ÐžÐ“Ð”Ð Ð¾Ð·Ð²ÑƒÑ‡Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ð¾Ñ‚ 500 Ñ€ÑƒÐ±. ÐÐž ÐÐ˜ÐšÐÐš ÐÐ• ÑÑ€Ð°Ð·Ñƒ ÑÐ°Ð¼Ð¸ Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚Ðµ Ð¾Ð± ÑÑ‚Ð¾Ð¼ Ð¸ ÐÐ• Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚Ðµ ÑÑ€Ð°Ð·Ñƒ, Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚ÑŒ ÐµÑ‘ Ð¿Ñ€Ð¸ Ð¸Ð·Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð¼ Ð¾Ð±Ñ‰ÐµÐ¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸.
Ð•ÑÐ»Ð¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð¿Ð¾ Ð²ÐµÑ€Ñ…Ð½ÐµÐ¹ Ð³Ñ€Ð°Ð½Ð¸Ñ†Ðµ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð”Ð˜ÐÐ“ÐÐžÐ¡Ð¢Ð˜ÐšÐ˜, Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚ ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚ Ð¿Ð¾ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐµ Ð¸ Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ ÑÑ‚Ð¾ Ñ‚Ð°ÐºÐ¶Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ Ñ Ð¼Ð°ÑÑ‚ÐµÑ€Ð¾Ð¼, Ñ‚Ð°ÐºÐ¶Ðµ Ð¢ÐžÐ›Ð¬ÐšÐž Ð¿Ñ€Ð¸ Ñ‚Ð°ÐºÐ¾Ð¼ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
ÐÐ° Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð¾ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð’Ð«Ð•Ð—Ð”Ð Ð¼Ð°ÑÑ‚ÐµÑ€Ð° Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾, Ñ‚Ð°ÐºÐ¶ÐµÐ½ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐ¹Ñ‚Ðµ ÑÑ‚Ñƒ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ, Ð° Ð½Ðµ ÑÐ°Ð¼Ð¸.
Ð•ÑÐ»Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð¾ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð°Ð´Ñ€ÐµÑÐ°, Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð½ÑƒÐ¶Ð½Ð¾ Ð´Ð»Ñ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸ Ð½Ð° Ð¼Ð°ÑÑ‚ÐµÑ€Ð° Ñ ÑƒÑ‡Ð°ÑÑ‚ÐºÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
Ð’Ð¡Ð•Ð“Ð”Ð ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð²Ð°Ñˆ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Saving_visit_date Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð´Ð°Ñ‚Ñ‹ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ð²Ð°ÑˆÐµÐ³Ð¾ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ - {time_str}. Ð•ÑÐ»Ð¸ Ð¾Ð½Ð¾ Ð´Ð¾ 19:00 - Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð² Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐµÐ³Ð¾Ð´Ð½ÑÑˆÐ½ÑŽ Ð´Ð°Ñ‚Ñƒ - {date}. Ð˜Ð½Ð°Ñ‡Ðµ Ð¶Ðµ, ÐµÑÐ»Ð¸ Ð¿Ð¾ÑÐ»Ðµ 19:00 - Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ°Ð¼Ð¸ ÑƒÐ¶Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð·Ð°Ð²Ñ‚Ñ€Ð°ÑˆÐ½ÑŽÑŽ Ð´Ð°Ñ‚Ñƒ.
Ð—Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ñ‚ÑŒ Ð´Ð°Ñ‚Ñƒ Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ÐÐ• ÐÐ£Ð–ÐÐž, Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐ¹Ñ‚Ðµ ÑÐ°Ð¼Ð¸!
Ð¢ÐžÐ›Ð¬ÐšÐž Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ, ÐµÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¡ÐÐœ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¿Ð¾ ÑÐ²Ð¾ÐµÐ¹ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ðµ ÑƒÐ¿Ð¾Ð¼ÑÐ½ÑƒÐ» Ð¾ Ð½ÑƒÐ¶Ð½Ð¾Ð¹ ÐµÐ¼Ñƒ Ð´Ð°Ñ‚Ðµ Ð²Ð¸Ð·Ð¸Ñ‚Ð° Ð¼Ð°ÑÑ‚ÐµÑ€Ð° Ð² Ð›Ð®Ð‘ÐžÐœ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐµÐ³Ð¾Ð´Ð½ÑÑˆÐ½ÐµÐ³Ð¾ Ð´Ð½Ñ - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÑÑ‚Ð¾ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ ÐµÑ‰Ñ‘ Ñ€Ð°Ð·, Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ñ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð°Ñ‚Ñƒ (Ð±ÐµÐ· Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸).
Ð•ÑÐ»Ð¸ Ð² Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¿ÐµÑ€ÐµÐ´Ð°ÑÑ‚ ÐºÐ°ÐºÑƒÑŽ-Ñ‚Ð¾ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð² Ñ†ÐµÐ»Ð¾Ð¼ Ð² Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ñ‡Ð°Ñ‚Ð°, Ð»ÑŽÐ±Ð¾Ð¼ ÑÐ²Ð¾ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸ Ð¸Ð»Ð¸ Ð´Ð°Ð¶Ðµ ÐµÐ³Ð¾ Ñ‡Ð°ÑÑ‚Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¾Ð± Ð»ÑŽÐ±Ñ‹Ñ… Ð¾Ð±ÑÑ‚Ð¾ÑÑ‚ÐµÐ»ÑŒÑÑ‚Ð²Ð°Ñ… Ð¸ Ð´ÐµÑ‚Ð°Ð»ÑÑ… Ð½ÐµÐ¸ÑÐ¿Ñ€Ð°Ð²Ð½Ð¾ÑÑ‚Ð¸ / ÑƒÑÐ»ÑƒÐ³Ð¸, Ð½ÑŽÐ°Ð½ÑÐ°Ñ… Ñ€Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°, Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° Ð¸ Ñ‚.Ð¿.), ÑÐ²Ð»ÑÑŽÑ‰ÑƒÑŽÑÑ Ð¿Ð¾Ð»ÐµÐ·Ð½Ð¾Ð¹ Ð´Ð»Ñ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸ Ð¸Ð»Ð¸ Ð²Ð°ÑˆÐ¸Ñ… ÐºÐ¾Ð»Ð»ÐµÐ³, Ð¼Ð°ÑÑ‚ÐµÑ€Ð¾Ð² Ð¸ Ñ‚.Ð´., Ñ‚Ð°ÐºÐ¶Ðµ Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÐšÐÐ–Ð”Ð£Ð® Ñ‚Ð°ÐºÑƒÑŽ Ð² Ð·Ð°ÑÐ²ÐºÑƒ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð°. ÐÐ¾ Ð½Ð¸ Ð² ÐºÐ¾ÐµÐ¼ ÑÐ»ÑƒÑ‡Ð°Ðµ ÐÐ•Ð›Ð¬Ð—Ð¯ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÑÑ‚Ð¾Ñ‚ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸, ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‰ÐµÐ¹ Ð´ÐµÑ‚Ð°Ð»Ð¸ Ð°Ð´Ñ€ÐµÑÐ° (ÐºÐ²Ð°Ñ€Ñ‚Ð¸Ñ€Ð°, Ð¿Ð¾Ð´ÑŠÐµÐ·Ð´ Ð¸ Ñ‚.Ð¿.) Ð¸Ð»Ð¸ Ð›Ð®Ð‘Ð«Ð• Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ñ‹ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°, Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ Ð¾Ð½ ÑÐ°Ð¼ Ð¿Ñ€Ð¾ÑÐ¸Ñ‚, Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ñƒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð²Ð°ÑˆÐ¸ Ð”Ð Ð£Ð“Ð˜Ð• ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹.
Ð’Ð°Ð¼ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð½Ð°Ð±Ð¾Ñ€ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð². Ð’Ð°Ð¼ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð¬ Ð²Ð°ÑˆÐ¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¡Ð ÐÐ—Ð£, ÐŸÐž ÐžÐ”ÐÐžÐœÐ£ Ð¸ ÐžÐ”ÐÐžÐšÐ ÐÐ¢ÐÐž, ÐºÐ°Ðº Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ.
Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ Ð·Ð°ÑÐ²ÐºÐ¸: {request}. Ð•ÑÐ»Ð¸ Ð² Ð·Ð°ÑÐ²ÐºÐµ Ð½Ðµ Ñ…Ð²Ð°Ñ‚Ð°ÐµÑ‚ ÐºÐ°ÐºÐ¾Ð³Ð¾-Ð»Ð¸Ð±Ð¾ Ð¿ÑƒÐ½ÐºÑ‚Ð° Ð¸Ð· Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð²Ñ‹ÑˆÐµ, Ñ‚Ð¾ Ð¢ÐžÐ›Ð¬ÐšÐž Ð¿Ñ€Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹Ñ‚Ðµ ÑÑ‚Ð¾Ñ‚ Ð¿ÑƒÐ½ÐºÑ‚ ÐŸÐž ÐžÐ”ÐÐžÐœÐ£, Ð° Ð½Ðµ Ð² Ð¾Ð´Ð½Ð¾Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸. ÐŸÐžÐ¡Ð›Ð• Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð¡Ð ÐÐ—Ð£ Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—Ð£Ð™Ð¢Ð• ÐžÐ”Ð˜Ð Ð¸Ð· Ð²Ð°ÑˆÐ¸Ñ… ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð² Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð·Ð°ÑÐ²ÐºÑƒ, Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ñ‚Ð¾ Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð±Ñ‹Ð»Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¾. Ð Ð½Ðµ ÑƒÐ¶Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… Ð´Ð°Ð½Ð½Ñ‹Ñ….
Ð”Ð°Ð»ÐµÐµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ñƒ Ð²Ð°Ñ ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð¸ "direction", Ð¸ "date", Ð¸ "phone", Ð¸ "latitude", Ð¸ "longitude", Ð¸ "address", Ð¸ "address_line_2" (Ð¸Ð»Ð¸ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐµ Ð±Ñ‹Ð»Ð¾ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð½Ð¾ÐºÑ€Ð°Ñ‚Ð½Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑˆÐµÐ½Ð¾), Ð¡ÐÐÐ§ÐÐ›Ð Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚Ðµ Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ ÑÑ€Ð°Ð·Ñƒ Ð’Ð¡Ð•Ð¥ Ð¢ÐžÐ›Ð¬ÐšÐž Ð­Ð¢Ð˜Ð¥ Ð¿ÐµÑ€ÐµÐ´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð¼ Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ "address_line_2" Ð¿Ñ€Ð¸ ÐµÐ³Ð¾ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ð¸, ÐÐž ÐšÐ ÐžÐœÐ• "direction", "date" Ð¸ "comment", Ð¿Ñ€Ð¸ÑÐ»Ð°Ð² Ð¸Ñ… ÐµÐ¼Ñƒ. Ð£Ñ‚Ð¾Ñ‡Ð½ÑÐ¹Ñ‚Ðµ Ð¢ÐžÐ›Ð¬ÐšÐž Ð¢ÐÐš, Ð¿Ð¾ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹ ÐÐ• Ð½ÑƒÐ¶Ð½Ð¾, ÐºÐ°Ðº ÐÐ• Ð½ÑƒÐ¶Ð½Ð¾ ÐÐ˜ÐšÐžÐ“Ð”Ð ÑƒÑ‚Ð¾Ñ‡Ð½ÑÑ‚ÑŒ "direction", "date" Ð¸ "comment". Ð’ ÑÑ‚Ð¾Ð¼ Ð¾Ð´Ð½Ð¾Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸ Ð²Ñ‹Ð½Ð¾ÑÐ¸Ñ‚Ðµ ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¿ÑƒÐ½ÐºÑ‚ Ð½Ð° Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð½Ð¾Ð²Ñ‹Ð¹ Ð°Ð±Ð·Ð°Ñ† c Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚ÐºÐ¾Ð¼ Ð¼ÐµÐ¶Ð´Ñƒ ÑÑ‚Ñ€Ð¾ÐºÐ°Ð¼Ð¸. Ð Ð¿Ð¾ÑÐ»Ðµ, Ð¢ÐžÐ›Ð¬ÐšÐž Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¯Ð’ÐÐžÐ“Ðž Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÐŸÐžÐ”Ð¢Ð’Ð•Ð Ð–Ð”Ð•ÐÐ˜Ð¯, Ð¡Ð ÐÐ—Ð£ ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—Ð£Ð™Ð¢Ð• Ð²Ð°Ñˆ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ "Create_request", Ð½Ð¾ Ð½Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð´Ñ€ÑƒÐ³Ð¸Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹. ÐŸÑ€Ð¾ÑÑ‚Ð¾Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚ "Ð´Ð°" Ñ‚Ð°ÐºÐ¶Ðµ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸ÐµÐ¼, ÐµÑ‰Ñ‘ Ñ€Ð°Ð· ÑƒÑ‚Ð¾Ñ‡Ð½ÑÑ‚ÑŒ ÐÐ• Ð½ÑƒÐ¶Ð½Ð¾. ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸ÐµÐ¼ ÐÐ• ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð»ÑŽÐ±Ð¾Ðµ Ð´Ñ€ÑƒÐ³Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ, ÑÐ²Ð½Ð¾ Ð½Ðµ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´Ð°ÑŽÑ‰ÐµÐµ Ð´Ð°Ð½Ð½Ñ‹Ðµ.
Ð•ÑÐ»Ð¸ Ð¶Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑƒÐºÐ°Ð·Ð°Ð» Ð½Ð° Ð½ÐµÑ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ñ…, ÑÐ½Ð¾Ð²Ð° Ð²Ñ‹Ð·Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ ÑÑ‚Ð¸Ñ… Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…. Ð˜ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾ Ð¿Ð¾ÑÐ»Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ¾Ð²Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ½Ð°Ñ‡Ð°Ð»Ð° ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾ÑÐ»Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹, Ð¿Ñ€ÐµÐ¶Ð´Ðµ Ñ‡ÐµÐ¼ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð·Ð°ÑÐ²ÐºÑƒ. ÐžÐ½Ð° ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ.
ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ, ÑƒÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ñ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÐºÐ¸.
Ð’ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÑŽÑ‰ÐµÐ¼ Ð²ÐµÑ‚ÐºÑƒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¿Ð¾ÑÐ»Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸, ÐµÑÐ»Ð¸ Ð²Ð°ÑˆÐµ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ - {time_str} - Ð´Ð¾ 19:00, Ð´Ð¾Ð½Ð¾ÑÐ¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð¼Ð°ÑÑ‚ÐµÑ€ ÑÐ²ÑÐ¶ÐµÑ‚ÑÑ Ñ Ð½Ð¸Ð¼ ÑÐµÐ³Ð¾Ð´Ð½Ñ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ñ‡Ð°ÑÐ°. Ð•ÑÐ»Ð¸ Ð³Ð¾Ñ€Ð¾Ð´ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð±ÑƒÑ€Ð³ Ð¸Ð»Ð¸ ÐÐ¾Ð²Ð¾ÑÐ¸Ð±Ð¸Ñ€ÑÐº, Ñ‚Ð¾ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð²ÑƒÑ… Ñ‡Ð°ÑÐ¾Ð², Ð½Ð¾ ÐÐ˜ Ð’ ÐšÐžÐ•Ðœ Ð¡Ð›Ð£Ð§ÐÐ• ÐÐ• Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ, Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð¸Ð·-Ð·Ð° Ð³Ð¾Ñ€Ð¾Ð´Ð°, Ð¿Ñ€Ð¸ÑÑ‹Ð»Ð°Ð¹Ñ‚Ðµ ÐµÐ¼Ñƒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸!
Ð•ÑÐ»Ð¸ Ð¶Ðµ Ð²Ð°ÑˆÐµ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ð¾ÑÐ»Ðµ 19:00, Ñ‚Ð¾ Ð´Ð¾Ð½Ð¾ÑÐ¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð¼Ð°ÑÑ‚ÐµÑ€ ÑÐ²ÑÐ¶ÐµÑ‚ÑÑ Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼ ÑƒÐ¶Ðµ Ð·Ð°Ð²Ñ‚Ñ€Ð°.
Ð¢Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð² Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð·Ð°ÑÐ²ÐºÐ¸ Ð²Ñ‹ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð»Ð¸ ÐµÑ‘ Ð½Ð¾Ð¼ÐµÑ€, Ð² ÑÑ‚Ð¾Ð¼ Ð¶Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÑŽÑ‰ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸ Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ.
ÐÐ° Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð½Ð¾ÑÑ‚Ð¸ Ð¶Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ, Ð° ÐÐ• ÐµÑ‰Ñ‘ Ñ€Ð°Ð· ÑƒÑ‚Ð¾Ñ‡Ð½ÑÐ¹Ñ‚Ðµ Ð¸Ð»Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐ¹Ñ‚Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ, Ñ‚Ð°Ðº ÐºÐ°Ðº ÑÑ‚Ð¾ Ð½Ðµ Ð½Ð¾Ð²Ð¾Ðµ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ.
ÐÐ• Ð·Ð´Ð¾Ñ€Ð¾Ð²Ð°Ð¹Ñ‚ÐµÑÑŒ ÐŸÐžÐ’Ð¢ÐžÐ ÐÐž Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°, Ð½Ð¾ Ð¾Ð´Ð½Ð¾ÐºÑ€Ð°Ñ‚Ð½Ð¾ Ð² Ð½Ð°Ñ‡Ð°Ð»Ðµ Ð½ÑƒÐ¶Ð½Ð¾.
chat_id Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ - {self.chat_id}"""

                # Read chat history in LLM fromat
                chat_history = await self.chat_history_service.read_chat_history(
                    self.chat_id,
                    self.message_id,
                )
                self.logger.info(f"History for {self.chat_id}: {chat_history}")

                if self.chat_agent is None:
                    self.chat_agent = ChatAgent(
                        self.config_manager.get("model"),
                        self.config_manager.get("temperature"),
                        self.config_manager.get("chats_dir"),
                        self.config_manager.get("request_dir"),
                        self.config_manager.get("proxy_url"),
                        self.config_manager.get("order_path"),
                        self.config_manager.get("ws_paths"),
                        self.config_manager.get("change_path"),
                        self.logger,
                        bot,
                    )
                    self.chat_agent.initialize_agent()

                bot_response = await self.chat_agent.agent_executor.ainvoke(
                    {
                        "system_prompt": system_prompt,
                        "input": user_message,
                        "chat_history": chat_history,
                    }
                )
                # await self.chat_history_service.save_to_chat_history(
                #     self.chat_id,
                #     user_message,
                #     self.message_id,
                #     "HumanMessage",
                #     "human",
                # )
                # await self.chat_history_service.save_to_chat_history(
                #     self.chat_id,
                #     bot_response["output"],
                #     self.message_id,
                #     "AIMessage",
                #     "llm",
                # )

                self.logger.info("Replying in " + str(self.chat_id))
                self.logger.info(f"Answer: {bot_response['output']}")
                return bot.send_message(self.chat_id, bot_response["output"])

        def split_audio_ffmpeg(audio_path, chunk_length=10 * 60):
            cmd_duration = f"ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 {audio_path}"
            duration = float(os.popen(cmd_duration).read())

            chunks_count = int(duration // chunk_length) + (
                1 if duration % chunk_length > 0 else 0
            )
            chunk_paths = []

            for i in range(chunks_count):
                start_time = i * chunk_length
                chunk_filename = f"/tmp/{uuid4()}.mp3"
                cmd_extract = f"ffmpeg -ss {start_time} -t {chunk_length} -i {audio_path} -acodec copy {chunk_filename}"
                os.system(cmd_extract)
                chunk_paths.append(chunk_filename)
            return chunk_paths

        def transcribe_audio_file(audio_path):
            OPENAI_API_KEY = os.environ.get("OPENAI_API_KEY", "")
            client = OpenAI(api_key=OPENAI_API_KEY)
            self.logger.info("Transcribing audio file..")
            chunk_paths = split_audio_ffmpeg(audio_path)
            full_text = ""

            for idx, chunk_path in enumerate(chunk_paths):
                self.logger.info(f"Processing chunk {idx+1} of {len(chunk_paths)}")
                chunk_audio = AudioSegment.from_file(chunk_path)
                with open(chunk_path, "rb") as audio_file:
                    text = client.audio.transcriptions.create(
                        file=audio_file,
                        model="whisper-1",
                        language="ru",
                        response_format="text",
                    )
                full_text += text
                os.remove(chunk_path)

            self.logger.info("Removing audio file..")
            os.remove(audio_path)
            self.logger.info("Transcription length: " + str(len(text)))

            return text


application = Application()
app = application.app
